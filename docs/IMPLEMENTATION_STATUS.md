# –°—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —É–ª—É—á—à–µ–Ω–∏–π —è–¥—Ä–∞

> **–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 2026-01-XX  
> **–í–µ—Ä—Å–∏—è —è–¥—Ä–∞:** 0.2.0  
> **–û—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞:** [CORE_ANALYSIS.md](CORE_ANALYSIS.md)

---

## üìä –°–≤–æ–¥–∫–∞

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | –ß–∞—Å—Ç–∏—á–Ω–æ | –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
|-----------|------------|----------|----------------|
| **–ö—Ä–∏—Ç–∏—á–Ω—ã–µ** | 3 | 0 | 1 |
| **–í–∞–∂–Ω—ã–µ** | 3 | 0 | 1 |
| **–°—Ä–µ–¥–Ω–∏–µ** | 0 | 0 | 4 |
| **–ò—Ç–æ–≥–æ** | 6 | 0 | 6 |

---

## üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. Graceful shutdown timeout

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- ‚úÖ –í `Config` –µ—Å—Ç—å –ø–æ–ª–µ `shutdown_timeout: int = 10`
- ‚úÖ –í `main.py` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `asyncio.wait_for(runtime.shutdown(), timeout=config.shutdown_timeout)`
- ‚úÖ –í `CoreRuntime.stop()` –¥–æ–±–∞–≤–ª–µ–Ω timeout –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
- ‚úÖ –ï—Å—Ç—å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–∏ timeout
- ‚úÖ –ï—Å—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ timeout —Å–æ–±—ã—Ç–∏–π
- ‚úÖ `CoreRuntime.__init__()` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π `config` –ø–∞—Ä–∞–º–µ—Ç—Ä

**–ì–¥–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- `core/config.py:30` - –µ—Å—Ç—å `shutdown_timeout`
- `main.py:31` - –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è config –≤ CoreRuntime
- `core/runtime.py:141-185` - –º–µ—Ç–æ–¥ `stop()` —Å timeout

---

### 2. Health checks

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- ‚úÖ –ï—Å—Ç—å `MonitoringModule` —Å –º–µ—Ç–æ–¥–æ–º `health_endpoint()`
- ‚úÖ –ï—Å—Ç—å health checks –≤ `remote_services/remote_logger.py` –∏ `remote_metrics.py`
- ‚úÖ –ï—Å—Ç—å health endpoint –≤ –ø–ª–∞–≥–∏–Ω–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, Client Manager)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π `health_check()` –≤ `CoreRuntime`
- ‚úÖ –ï—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (Storage, –º–æ–¥—É–ª–∏, –ø–ª–∞–≥–∏–Ω—ã)
- ‚úÖ –ï—Å—Ç—å HealthStatus enum (–ª–æ–∫–∞–ª—å–Ω–æ –≤ –º–µ—Ç–æ–¥–µ)
- ‚úÖ –ú–µ—Ç–æ–¥ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º –∏ –¥–µ—Ç–∞–ª—è–º–∏

**–ì–¥–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- `modules/monitoring/monitoring_module.py:53-66` - –µ—Å—Ç—å health_endpoint
- `core/remote_services/remote_logger.py:56-57` - –µ—Å—Ç—å health endpoint
- `core/runtime.py:187-240` - –º–µ—Ç–æ–¥ `health_check()`

---

### 3. –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- ‚úÖ –ï—Å—Ç—å `remote_metrics` –ø–ª–∞–≥–∏–Ω –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫
- ‚úÖ –ï—Å—Ç—å `MonitoringModule` —Å Prometheus –º–µ—Ç—Ä–∏–∫–∞–º–∏
- ‚úÖ –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö –µ—Å—Ç—å —Å—á—ë—Ç—á–∏–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, health_requests_total)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `get_metrics()` –≤ `CoreRuntime`
- ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ –≤–∫–ª—é—á–∞—é—Ç: –ø–ª–∞–≥–∏–Ω—ã (total, started, states), –º–æ–¥—É–ª–∏ (total, list), —Å–µ—Ä–≤–∏—Å—ã (total), storage (available)

**–ì–¥–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- `core/remote_services/remote_metrics.py` - –µ—Å—Ç—å remote metrics –ø–ª–∞–≥–∏–Ω
- `modules/monitoring/monitoring_module.py` - –µ—Å—Ç—å Prometheus –º–µ—Ç—Ä–∏–∫–∏
- `core/runtime.py:242-295` - –º–µ—Ç–æ–¥ `get_metrics()`

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ú–µ—Ç—Ä–∏–∫–∏ –≤ `ServiceRegistry` –∏ `EventBus` (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–∑–æ–≤–æ–≤, –æ—à–∏–±–æ–∫, —Å–æ–±—ã—Ç–∏–π) –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã - —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –±—É–¥—É—â–µ–º –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

---

### 4. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ Storage

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `transaction()` –≤ `StorageAdapter` (–±–∞–∑–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω `transaction()` –≤ `SQLiteAdapter` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π BEGIN/COMMIT/ROLLBACK
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω `transaction()` –≤ `PostgreSQLAdapter` —á–µ—Ä–µ–∑ asyncpg.transaction()
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `transaction()` –≤ `Storage` –∫–∞–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `transaction_callback()` –≤ `Storage` –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- ‚úÖ –û–ø–µ—Ä–∞—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–µ –¥–µ–ª–∞—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π commit

**–ì–¥–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- `adapters/storage_adapter.py` - –±–∞–∑–æ–≤—ã–π –º–µ—Ç–æ–¥ transaction()
- `adapters/sqlite_adapter.py` - —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è SQLite
- `adapters/postgresql_adapter.py` - —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è PostgreSQL
- `core/storage.py` - –º–µ—Ç–æ–¥—ã transaction() –∏ transaction_callback()

---

## üü° –í–∞–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 5. Timeout –¥–ª—è ServiceRegistry

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `call_with_timeout()` –≤ `ServiceRegistry`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `asyncio.wait_for()` –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –∑–∞–≤–∏—Å—à–∏—Ö –≤—ã–∑–æ–≤–æ–≤
- ‚úÖ –í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç `asyncio.TimeoutError` –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ timeout

**–ì–¥–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- `core/service_registry.py:93-120` - –º–µ—Ç–æ–¥ `call_with_timeout()`

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è timeout –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞ - timeout –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è —è–≤–Ω–æ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤—ã–∑–æ–≤–µ. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≥–∏–±–∫–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å timeout –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.

---

### 6. –£–ø—Ä–æ—â–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- ‚úÖ –£–ø—Ä–æ—â–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π –¥–æ –æ–¥–Ω–æ–≥–æ –∫—Ä–∏—Ç–µ—Ä–∏—è - —Ç–æ–ª—å–∫–æ —è–≤–Ω–∞—è –ø–æ–º–µ—Ç–∫–∞ –≤ manifest
- ‚úÖ –£–¥–∞–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞ —á–µ—Ä–µ–∑ `inspect.getsource()` (–º–µ–¥–ª–µ–Ω–Ω–æ –∏ –Ω–µ–Ω–∞–¥—ë–∂–Ω–æ)
- ‚úÖ –£–¥–∞–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º (–∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞)
- ‚úÖ –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ `manifest.get("is_integration", False)` –∫–∞–∫ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã

**–ì–¥–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- `core/plugin_manager.py:546-600` - —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π –º–µ—Ç–æ–¥ `_detect_and_register_integration()`

---

### 7. Middleware/interceptors –¥–ª—è ServiceRegistry

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –∫–ª–∞—Å—Å `ServiceMiddleware` —Å –º–µ—Ç–æ–¥–∞–º–∏ `before_call()`, `after_call()`, `on_error()`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `register_with_middleware()` –≤ `ServiceRegistry`
- ‚úÖ Middleware –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ (before_call ‚Üí –≤—ã–∑–æ–≤ ‚Üí after_call –∏–ª–∏ on_error)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö middleware –¥–ª—è –æ–¥–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞

**–ì–¥–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- `core/service_registry.py:17-58` - –∫–ª–∞—Å—Å `ServiceMiddleware`
- `core/service_registry.py:53-95` - –º–µ—Ç–æ–¥ `register_with_middleware()`

---

### 8. –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API

**–°—Ç–∞—Ç—É—Å:** ‚ùå **–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- –ù–∏—á–µ–≥–æ

**–ß—Ç–æ –ù–ï —Å–¥–µ–ª–∞–Ω–æ:**
- ‚ùå –ù–µ—Ç –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤ `ServiceRegistry` (–Ω–∞–ø—Ä–∏–º–µ—Ä, "service.v1.method")
- ‚ùå –ù–µ—Ç –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤ `HttpRegistry` (–Ω–∞–ø—Ä–∏–º–µ—Ä, "/v1/endpoint")
- ‚ùå –ù–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤–µ—Ä—Å–∏–π

**–ì–¥–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- `core/service_registry.py` - –Ω–µ—Ç –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- `core/http_registry.py` - –Ω–µ—Ç –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

**–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:**
```python
# –í ServiceRegistry
async def register(self, service_name: str, func: ServiceFunc, version: str = "v1") -> None:
    """–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å —Å –≤–µ—Ä—Å–∏–µ–π."""
    versioned_name = f"{service_name}.{version}" if version else service_name
    await self._register_internal(versioned_name, func)

# –í HttpRegistry
def register(self, endpoint: HttpEndpoint, version: str = "v1") -> None:
    """–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å endpoint —Å –≤–µ—Ä—Å–∏–µ–π."""
    versioned_path = f"/{version}{endpoint.path}" if version else endpoint.path
    versioned_endpoint = HttpEndpoint(
        method=endpoint.method,
        path=versioned_path,
        service=endpoint.service,
        description=endpoint.description
    )
    self._register_internal(versioned_endpoint)
```

---

## üü¢ –°—Ä–µ–¥–Ω–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### 9. Batch –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ Storage

**–°—Ç–∞—Ç—É—Å:** ‚ùå **–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- –ù–∏—á–µ–≥–æ

**–ß—Ç–æ –ù–ï —Å–¥–µ–ª–∞–Ω–æ:**
- ‚ùå –ù–µ—Ç –º–µ—Ç–æ–¥–∞ `batch_set()` –≤ `Storage`
- ‚ùå –ù–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
- ‚ùå –ù–µ—Ç batch –æ–ø–µ—Ä–∞—Ü–∏–π –≤ –∞–¥–∞–ø—Ç–µ—Ä–∞—Ö

**–ì–¥–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- `core/storage.py` - –Ω–µ—Ç batch –º–µ—Ç–æ–¥–æ–≤
- `adapters/storage_adapter.py` - –Ω–µ—Ç batch –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

**–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:**
```python
# –í StorageAdapter
@abstractmethod
async def batch_set(self, namespace: str, items: Dict[str, dict[str, Any]]) -> None:
    """–ú–∞—Å—Å–æ–≤–∞—è –∑–∞–ø–∏—Å—å –∑–Ω–∞—á–µ–Ω–∏–π."""
    pass

# –í Storage
async def batch_set(self, namespace: str, items: Dict[str, dict[str, Any]]) -> None:
    """–ú–∞—Å—Å–æ–≤–∞—è –∑–∞–ø–∏—Å—å –∑–Ω–∞—á–µ–Ω–∏–π."""
    await self._adapter.batch_set(namespace, items)
```

---

### 10. TTL –≤ StateEngine

**–°—Ç–∞—Ç—É—Å:** ‚ùå **–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- –ù–∏—á–µ–≥–æ

**–ß—Ç–æ –ù–ï —Å–¥–µ–ª–∞–Ω–æ:**
- ‚ùå –ù–µ—Ç –º–µ—Ç–æ–¥–∞ `set_with_ttl()` –≤ `StateEngine`
- ‚ùå –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚ùå –ù–µ—Ç —Ñ–æ–Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏

**–ì–¥–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- `core/state_engine.py` - –Ω–µ—Ç TTL –º–µ—Ç–æ–¥–æ–≤

**–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:**
```python
# –í StateEngine
def __init__(self):
    self._state: dict[str, Any] = {}
    self._ttl: dict[str, float] = {}  # key -> expiration timestamp
    self._lock = asyncio.Lock()
    self._cleanup_task: Optional[asyncio.Task] = None

async def set_with_ttl(self, key: str, value: Any, ttl_seconds: float) -> None:
    """–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ —Å TTL."""
    async with self._lock:
        self._state[key] = value
        self._ttl[key] = time.time() + ttl_seconds

async def _cleanup_expired(self):
    """–§–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –∏—Å—Ç—ë–∫—à–∏—Ö –∫–ª—é—á–µ–π."""
    while True:
        await asyncio.sleep(60)  # –ö–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
        now = time.time()
        async with self._lock:
            expired = [k for k, exp in self._ttl.items() if exp < now]
            for k in expired:
                del self._state[k]
                del self._ttl[k]
```

---

### 11. Hot-reload –ø–ª–∞–≥–∏–Ω–æ–≤

**–°—Ç–∞—Ç—É—Å:** ‚ùå **–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- –ù–∏—á–µ–≥–æ

**–ß—Ç–æ –ù–ï —Å–¥–µ–ª–∞–Ω–æ:**
- ‚ùå –ù–µ—Ç –º–µ—Ç–æ–¥–∞ `reload_plugin()` –≤ `PluginManager`
- ‚ùå –ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–∏—Ç—å –ø–ª–∞–≥–∏–Ω –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ runtime
- ‚ùå –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞—Ö

**–ì–¥–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- `core/plugin_manager.py` - –Ω–µ—Ç reload –º–µ—Ç–æ–¥–æ–≤

**–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:**
```python
# –í PluginManager
async def reload_plugin(self, plugin_name: str) -> None:
    """–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–ª–∞–≥–∏–Ω."""
    # 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–ª–∞–≥–∏–Ω
    await self.stop_plugin(plugin_name)
    
    # 2. –í—ã–≥—Ä—É–∑–∏—Ç—å –ø–ª–∞–≥–∏–Ω
    await self.unload_plugin(plugin_name)
    
    # 3. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –º–∞–Ω–∏—Ñ–µ—Å—Ç
    # 4. –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–ª–∞–≥–∏–Ω –∑–∞–Ω–æ–≤–æ
    # 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–ª–∞–≥–∏–Ω
```

---

### 12. OpenAPI –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è

**–°—Ç–∞—Ç—É—Å:** ‚ùå **–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- –ù–∏—á–µ–≥–æ

**–ß—Ç–æ –ù–ï —Å–¥–µ–ª–∞–Ω–æ:**
- ‚ùå –ù–µ—Ç –º–µ—Ç–æ–¥–∞ `generate_openapi()` –≤ `HttpRegistry`
- ‚ùå –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ OpenAPI —Å—Ö–µ–º—ã
- ‚ùå –ù–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å FastAPI/Swagger

**–ì–¥–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- `core/http_registry.py` - –Ω–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ OpenAPI

**–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:**
```python
# –í HttpRegistry
def generate_openapi(self, title: str = "Core Runtime API", version: str = "1.0.0") -> Dict:
    """–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å OpenAPI —Å—Ö–µ–º—É."""
    paths = {}
    for endpoint in self._endpoints:
        path = endpoint.path
        method = endpoint.method.lower()
        
        if path not in paths:
            paths[path] = {}
        
        paths[path][method] = {
            "summary": endpoint.description or f"{method.upper()} {path}",
            "operationId": endpoint.service.replace(".", "_"),
            "responses": {
                "200": {
                    "description": "Success",
                    "content": {
                        "application/json": {
                            "schema": {"type": "object"}
                        }
                    }
                }
            }
        }
    
    return {
        "openapi": "3.0.0",
        "info": {"title": title, "version": version},
        "paths": paths
    }
```

---

## üìà –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ (4 –∑–∞–¥–∞—á–∏)
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: 3 –∑–∞–¥–∞—á–∏ (75%)
- ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: 1 –∑–∞–¥–∞—á–∞ (25%)

### –í–∞–∂–Ω—ã–µ (4 –∑–∞–¥–∞—á–∏)
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: 3 –∑–∞–¥–∞—á–∏ (75%)
- ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: 1 –∑–∞–¥–∞—á–∞ (25%)

### –°—Ä–µ–¥–Ω–∏–µ (4 –∑–∞–¥–∞—á–∏)
- ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: 4 –∑–∞–¥–∞—á–∏ (100%)

---

## üéØ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –°–ª–µ–¥—É—é—â–∏–π —Å–ø—Ä–∏–Ω—Ç (1-2 –Ω–µ–¥–µ–ª–∏)

1. **–î–æ—Ä–∞–±–æ—Ç–∞—Ç—å graceful shutdown timeout** –≤ `CoreRuntime.stop()`
   - –î–æ–±–∞–≤–∏—Ç—å timeout –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
   - –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
   - –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

2. **–î–æ–±–∞–≤–∏—Ç—å health_check()** –≤ `CoreRuntime`
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - HealthStatus enum
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ API

3. **–î–æ–±–∞–≤–∏—Ç—å get_metrics()** –≤ `CoreRuntime`
   - –ú–µ—Ç—Ä–∏–∫–∏ –ø–ª–∞–≥–∏–Ω–æ–≤, –º–æ–¥—É–ª–µ–π, —Å–µ—Ä–≤–∏—Å–æ–≤
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å MonitoringModule

4. **–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏** –≤ Storage
   - –ú–µ—Ç–æ–¥ transaction() –≤ StorageAdapter
   - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ SQLite –∏ PostgreSQL –∞–¥–∞–ø—Ç–µ—Ä–∞—Ö
   - –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä

### –°–ª–µ–¥—É—é—â–∏–π —Å–ø—Ä–∏–Ω—Ç (2-3 –Ω–µ–¥–µ–ª–∏)

5. **Timeout –¥–ª—è ServiceRegistry**
6. **–£–ø—Ä–æ—Å—Ç–∏—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π**
7. **Middleware –¥–ª—è ServiceRegistry**
8. **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API**

### –ë—É–¥—É—â–∏–µ —Å–ø—Ä–∏–Ω—Ç—ã

9. **Batch –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ Storage**
10. **TTL –≤ StateEngine**
11. **Hot-reload –ø–ª–∞–≥–∏–Ω–æ–≤**
12. **OpenAPI –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è**

---

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:**
- ‚úÖ **6 –∑–∞–¥–∞—á –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã** (50%)
- ‚ùå **6 –∑–∞–¥–∞—á –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã** (50%)

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**
1. ‚úÖ Graceful shutdown timeout –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ CoreRuntime
2. ‚úÖ Health checks - –¥–æ–±–∞–≤–ª–µ–Ω —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π API –≤ CoreRuntime
3. ‚úÖ –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ - –¥–æ–±–∞–≤–ª–µ–Ω get_metrics() –≤ CoreRuntime
4. ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ Storage - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –¥–ª—è SQLite –∏ PostgreSQL
5. ‚úÖ Timeout –¥–ª—è ServiceRegistry - –¥–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ call_with_timeout()
6. ‚úÖ Middleware/interceptors –¥–ª—è ServiceRegistry - –¥–æ–±–∞–≤–ª–µ–Ω ServiceMiddleware –∏ register_with_middleware()
7. ‚úÖ –£–ø—Ä–æ—â–µ–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π –¥–æ –æ–¥–Ω–æ–≥–æ –∫—Ä–∏—Ç–µ—Ä–∏—è (—Ç–æ–ª—å–∫–æ manifest)

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–µ–ª—ã:**
1. –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API - –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
2. Batch –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ Storage - –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
3. TTL –≤ StateEngine - –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
4. Hot-reload –ø–ª–∞–≥–∏–Ω–æ–≤ - –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
5. OpenAPI –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è - –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–∞–±–æ—Ç—É –Ω–∞–¥ –≤–∞–∂–Ω—ã–º–∏ —É–ª—É—á—à–µ–Ω–∏—è–º–∏ (–≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API) –∏ —Å—Ä–µ–¥–Ω–∏–º–∏ —É–ª—É—á—à–µ–Ω–∏—è–º–∏ (batch –æ–ø–µ—Ä–∞—Ü–∏–∏, TTL, hot-reload, OpenAPI).
